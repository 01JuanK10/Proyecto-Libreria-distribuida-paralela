<div class="libros-container">
    <h2>Gestión de Libros</h2>
  
    <div class="actions">
      <button class="btn agregar" (click)="abrirModalNuevoLibro()">Agregar nuevo libro</button>
      <button class="btn prestamo" (click)="registrarPrestamo()">Registrar préstamo</button>
      <button class="btn devuelto" (click)="marcarDevuelto()">Marcar como devuelto</button>
    </div>
  
    <table class="libros-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>Título</th>
          <th>Autor</th>
          <th>Editorial</th>
          <th>Género</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        @for (libro of libros; track libro.id) {
          <tr>
            <td>{{ libro.id }}</td>
            <td>{{ libro.titulo }}</td>
            <td>{{ libro.autor }}</td>
            <td>{{ libro.editorial }}</td>
            <td>{{ libro.genero }}</td>
            <td [class.prestado]="libro.prestado" >
              {{ libro.prestado ? 'Prestado' : 'Disponible' }}
            </td>
          </tr>
        }
      </tbody>      
    </table>
  </div>
  
  @if (showModal) {
    <app-modal [isVisible]="showModal" [title]="modalTitle" (cerrar)="showModal = false">
      @switch (accion) {
        @case ('agregar') {
          <form class="form-libro">
            <div class="form-grid">
              <div class="form-group full-width">
                <h3 >Agregar nuevo libro</h3>
              </div>

              <div class="form-group">
                <label for="id">ID del libro</label>
                <input type="text" id="id" [(ngModel)]="nuevoLibro.id" name="id" placeholder="Ej. 101" />
              </div>
    
              <div class="form-group">
                <label for="titulo">Título</label>
                <input type="text" id="titulo" [(ngModel)]="nuevoLibro.titulo" name="titulo" placeholder="Ej. Cien años de soledad" />
              </div>
    
              <div class="form-group">
                <label for="autor">Autor</label>
                <input type="text" id="autor" [(ngModel)]="nuevoLibro.autor" name="autor" placeholder="Ej. Gabriel García Márquez" />
              </div>
    
              <div class="form-group">
                <label for="editorial">Editorial</label>
                <input type="text" id="editorial" [(ngModel)]="nuevoLibro.editorial" name="editorial" placeholder="Ej. Sudamericana" />
              </div>
    
              <div class="form-group full-width">
                <label for="genero">Género</label>
                <input type="text" id="genero" [(ngModel)]="nuevoLibro.genero" name="genero" placeholder="Ej. Realismo mágico" />
              </div>
            </div>
    
            <div class="form-actions">
              <button type="button" class="btn cancelar" (click)="showModal = false">Cancelar</button>
              <button type="button" class="btn confirmar" (click)="confirmarAccion()">Guardar</button>
            </div>
          </form>
        }

        @case ('registrarPrestamo') {
          <div class="form-prestamo">
            <h3>Registrar Préstamo</h3>
          
            <div class="datos-contenedor">
              <div class="columna">
                <div class="form-group">
                  <label for="libroId">ID del libro:</label>
                  <input
                    type="number"
                    id="libroId"
                    [(ngModel)]="libroId"
                    name="libroId"
                    placeholder="Ej. 1"
                    (change)="cargarDatosLibro()"
                  />
                </div>
          
                <h4>Datos del Libro</h4>
                <div class="form-group">
                  <label>Título:</label>
                  <input type="text" [(ngModel)]="libroSeleccionado.titulo" name="tituloLibro" readonly />
                </div>
                <div class="form-group">
                  <label>Autor:</label>
                  <input type="text" [(ngModel)]="libroSeleccionado.autor" name="autorLibro" readonly />
                </div>
                <div class="form-group">
                  <label>Editorial:</label>
                  <input type="text" [(ngModel)]="libroSeleccionado.editorial" name="editorialLibro" readonly />
                </div>
              </div>
          
              <div class="columna">
                <div class="form-group">
                  <label for="clienteCC">CC del cliente:</label>
                  <input
                    type="number"
                    id="clienteCC"
                    [(ngModel)]="clienteCC"
                    name="clienteCC"
                    placeholder="Ej. 101"
                    (change)="cargarDatosCliente()"
                  />
                </div>
          
                <h4>Datos del Cliente</h4>
                <div class="form-group">
                  <label>Nombre:</label>
                  <input type="text" [(ngModel)]="clienteSeleccionado.nombre" name="nombreCliente" readonly />
                </div>
                <div class="form-group">
                  <label>Apellido:</label>
                  <input type="text" [(ngModel)]="clienteSeleccionado.apellido" name="apellidoCliente" readonly />
                </div>
              </div>
            </div>
          
            <div class="form-actions">
              <button type="button" class="btn cancelar" (click)="cerrarModal()">Cancelar</button>
              <button type="button" class="btn confirmar" (click)="confirmarAccionPrestamo()">Registrar Préstamo</button>
            </div>
          </div>          
        }

        @case ('registrarDevolucion') {
          <div class="form-prestamo">
            <h3>Registrar Devolución</h3>
          
            <div class="datos-contenedor">
              <div class="columna">
                <div class="form-group">
                  <label for="libroId">ID del libro:</label>
                  <input
                    type="number"
                    id="libroId"
                    [(ngModel)]="libroId"
                    name="libroId"
                    placeholder="Ej. 1"
                    (change)="cargarDatosLibro()"
                  />
                </div>
          
                <h4>Datos del Libro</h4>
                <div class="form-group">
                  <label>Título:</label>
                  <input type="text" [(ngModel)]="libroSeleccionado.titulo" name="tituloLibro" readonly />
                </div>
                <div class="form-group">
                  <label>Autor:</label>
                  <input type="text" [(ngModel)]="libroSeleccionado.autor" name="autorLibro" readonly />
                </div>
                <div class="form-group">
                  <label>Editorial:</label>
                  <input type="text" [(ngModel)]="libroSeleccionado.editorial" name="editorialLibro" readonly />
                </div>
              </div>
          
              <div class="columna">
                <div class="form-group">
                  <label for="clienteCC">CC del cliente:</label>
                  <input
                    type="number"
                    id="clienteCC"
                    [(ngModel)]="clienteCC"
                    name="clienteCC"
                    placeholder="Ej. 101"
                    (change)="cargarDatosCliente()"
                  />
                </div>
          
                <h4>Datos del Cliente</h4>
                <div class="form-group">
                  <label>Nombre:</label>
                  <input type="text" [(ngModel)]="clienteSeleccionado.nombre" name="nombreCliente" readonly />
                </div>
                <div class="form-group">
                  <label>Apellido:</label>
                  <input type="text" [(ngModel)]="clienteSeleccionado.apellido" name="apellidoCliente" readonly />
                </div>
              </div>
            </div>
          
            <div class="form-actions">
              <button type="button" class="btn cancelar" (click)="cerrarModal()">Cancelar</button>
              <button type="button" class="btn confirmar" (click)="confirmarAccionDevolucion()">Registrar Devolución</button>
            </div>
          </div>          
        }
      }
    </app-modal>
  }
  